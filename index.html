<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>LifeSync Ultra</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
.fade { animation: fade 0.4s ease }
@keyframes fade {
  from {opacity:0; transform:translateY(10px)}
  to {opacity:1; transform:translateY(0)}
}
.glass {
  backdrop-filter: blur(10px);
  background: rgba(255,255,255,0.75);
}
.dark .glass {
  background: rgba(30,41,59,0.75);
}
</style>
</head>

<body class="bg-gradient-to-br from-indigo-100 to-blue-100 dark:from-slate-900 dark:to-slate-800 min-h-screen p-6 text-gray-800 dark:text-gray-100">

<h1 class="text-4xl font-black text-center mb-2">ğŸ§  LifeSync Ultra</h1>
<p class="text-center opacity-80 mb-6">DÃ©cide quoi faire. Fais-le. Respire.</p>

<!-- AJOUT TÃ‚CHE -->
<div class="glass rounded-xl p-4 mb-6 shadow fade">
  <h2 class="font-bold mb-2">â• Nouvelle tÃ¢che</h2>
  <div class="flex gap-2 flex-wrap">
    <input id="title" placeholder="TÃ¢che" class="p-2 rounded border w-full sm:w-auto">
    <input id="duration" type="number" placeholder="DurÃ©e (min)" class="p-2 rounded border w-32">
    <select id="priority" class="p-2 rounded border">
      <option value="1">ğŸŸ¢ Faible</option>
      <option value="3">ğŸŸ¡ Moyenne</option>
      <option value="5">ğŸ”´ Haute</option>
    </select>
    <button onclick="addTask()" class="bg-indigo-600 text-white px-4 rounded">Ajouter</button>
  </div>
</div>

<!-- Ã‰NERGIE -->
<div class="glass rounded-xl p-4 mb-6 shadow fade">
  <h2 class="font-bold mb-2">âš¡ Ã‰nergie actuelle</h2>
  <input id="energy" type="range" min="0" max="100" class="w-full">
  <p id="energyText" class="mt-1">80%</p>
</div>

<!-- ACTION PRINCIPALE -->
<div class="text-center mb-6 fade">
  <button onclick="decideTask()" class="bg-emerald-600 text-white px-6 py-3 rounded-xl text-lg shadow">
    ğŸ¤” Que dois-je faire maintenant ?
  </button>
</div>

<!-- TÃ‚CHE ACTUELLE -->
<div id="currentTask" class="glass rounded-xl p-4 mb-6 shadow hidden fade"></div>

<!-- LISTE -->
<div class="glass rounded-xl p-4 mb-6 shadow fade">
  <h2 class="font-bold mb-2">ğŸ“‹ TÃ¢ches restantes</h2>
  <ul id="taskList"></ul>
</div>

<!-- STATS -->
<div class="glass rounded-xl p-4 shadow fade">
  <h2 class="font-bold mb-2">ğŸ“Š Aujourdâ€™hui</h2>
  <p id="stats"></p>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let workedMinutes = Number(localStorage.getItem("worked")) || 0;

const energyInput = document.getElementById("energy");
const energyText = document.getElementById("energyText");

energyInput.oninput = () => energyText.textContent = energyInput.value + "%";

function save() {
  localStorage.setItem("tasks", JSON.stringify(tasks));
  localStorage.setItem("worked", workedMinutes);
}

function addTask() {
  const t = title.value.trim();
  if(!t) return;
  tasks.push({
    title:t,
    duration:Number(duration.value||30),
    priority:Number(priority.value)
  });
  title.value="";
  render();
  save();
}

function render() {
  taskList.innerHTML="";
  tasks.forEach((t,i)=>{
    const li=document.createElement("li");
    li.className="p-2 rounded mb-1 bg-white/60 dark:bg-slate-700/60";
    li.textContent=`${t.title} â€¢ ${t.duration} min`;
    taskList.appendChild(li);
  });
  stats.textContent=`â±ï¸ Temps travaillÃ© : ${workedMinutes} min`;
}

function decideTask() {
  if(tasks.length===0) return;
  const energy = Number(energyInput.value);
  let sorted = [...tasks].sort((a,b)=>{
    let scoreA = a.priority*2 - a.duration + energy;
    let scoreB = b.priority*2 - b.duration + energy;
    return scoreB-scoreA;
  });
  const task = sorted[0];
  currentTask.innerHTML = `
    <h2 class="text-xl font-bold mb-2">ğŸ¯ Fais maintenant :</h2>
    <p class="mb-2">${task.title}</p>
    <p class="opacity-80 mb-4">â±ï¸ ${task.duration} min</p>
    <button onclick="completeTask('${task.title}')" class="bg-indigo-600 text-white px-4 py-2 rounded">
      âœ… TerminÃ©
    </button>
  `;
  currentTask.classList.remove("hidden");
}

function completeTask(title) {
  const t = tasks.find(x=>x.title===title);
  workedMinutes += t.duration;
  tasks = tasks.filter(x=>x.title!==title);
  currentTask.classList.add("hidden");
  render();
  save();
}

render();
</script>

</body>
</html>
