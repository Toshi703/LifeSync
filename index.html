<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>LifeSync Pro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { font-family: sans-serif; transition: background-color 0.3s, color 0.3s;}
.dark body { background-color: #1e293b; color: #f1f5f9;}
.fade-in { animation: fadeIn 0.5s ease forwards;}
@keyframes fadeIn { from {opacity:0; transform: translateY(10px);} to {opacity:1; transform: translateY(0);} }
</style>
</head>
<body class="bg-gray-100 p-8">

<h1 class="text-4xl font-bold mb-6 text-center">ğŸŒŸ LifeSync Pro ğŸŒŸ</h1>
<p class="text-center mb-6">GÃ¨re tes tÃ¢ches et ton Ã©nergie efficacement !</p>

<!-- Ajouter une tÃ¢che -->
<div class="mb-6 p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">Ajouter une tÃ¢che</h2>
  <input id="title" placeholder="Titre" class="border p-2 mr-2 rounded"/>
  <input id="duration" type="number" placeholder="DurÃ©e (min)" class="border p-2 mr-2 rounded w-24"/>
  <input id="priority" type="number" placeholder="PrioritÃ© (1-5)" min="1" max="5" value="1"
         class="border p-2 mr-2 rounded w-24"/>
  <button onclick="addTask()" class="bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition">Ajouter</button>
</div>

<!-- Liste des tÃ¢ches -->
<div class="mb-6 p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">TÃ¢ches</h2>
  <ul id="taskList"></ul>
</div>

<!-- Historique tÃ¢ches terminÃ©es -->
<div class="mb-6 p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">Historique des tÃ¢ches terminÃ©es</h2>
  <ul id="completedList"></ul>
</div>

<!-- Suggestion prochaine tÃ¢che -->
<div id="nextTaskDiv" class="mb-6 p-4 bg-green-100 dark:bg-green-900 rounded shadow hidden">
  <h2 class="text-xl font-semibold mb-2">Prochaine tÃ¢che suggÃ©rÃ©e</h2>
  <p id="nextTaskText"></p>
</div>

<!-- Alertes Ã©nergie / micro-pauses -->
<div id="energyAlert" class="mb-6 p-4 rounded shadow hidden"></div>

<!-- Slider Ã©nergie -->
<div class="mb-6 p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">Niveau d'Ã©nergie</h2>
  <input id="energy" type="range" min="0" max="100" value="80" class="w-full mb-2"/>
  <button onclick="logEnergy()" class="bg-yellow-500 p-2 rounded text-white hover:bg-yellow-600 transition">Enregistrer Ã©nergie</button>
  <p id="lastEnergy">DerniÃ¨re Ã©nergie : 80</p>
</div>

<!-- Graphique Ã©nergie -->
<div class="p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">Graphique d'Ã©nergie</h2>
  <canvas id="energyChart"></canvas>
</div>

<!-- Badge motivant -->
<div id="badgeDiv" class="mt-6 p-4 bg-indigo-100 dark:bg-indigo-900 rounded shadow hidden">
  <h2 class="text-xl font-semibold mb-2">Badge du jour ğŸ†</h2>
  <p id="badgeText"></p>
</div>

<audio id="alertSound">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
</audio>

<script>
let tasks = [];
let completedTasks = [];
let energyLog = [80];
let lastEnergy = 80;

// Mode sombre automatique
if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
  document.body.classList.add('dark');
}

// Ajouter une tÃ¢che
function addTask() {
  const title = document.getElementById('title').value.trim();
  const duration = parseInt(document.getElementById('duration').value);
  const priority = parseInt(document.getElementById('priority').value);
  if (!title) return;

  tasks.push({title,duration,priority});
  document.getElementById('title').value='';
  document.getElementById('duration').value='30';
  document.getElementById('priority').value='1';

  renderTasks();
  suggestNextTask();
  updateBadge();
}

// Afficher les tÃ¢ches
function renderTasks() {
  const list = document.getElementById('taskList');
  list.innerHTML = '';
  tasks.forEach((t,i)=>{
    const li = document.createElement('li');
    li.textContent = `${t.title} - ${t.duration} min - prioritÃ© ${t.priority}`;
    li.className = `p-1 rounded mb-1 fade-in ${priorityColor(t.priority)}`;
    li.onclick = ()=>completeTask(i);
    list.appendChild(li);
  });
}

// Marquer tÃ¢che comme terminÃ©e
function completeTask(index){
  const task = tasks.splice(index,1)[0];
  completedTasks.push(task);
  renderTasks();
  renderCompleted();
  suggestNextTask();
  updateBadge();
}

// Afficher historique terminÃ©
function renderCompleted(){
  const list = document.getElementById('completedList');
  list.innerHTML = '';
  completedTasks.forEach(t=>{
    const li = document.createElement('li');
    li.textContent = `${t.title} - ${t.duration} min - prioritÃ© ${t.priority}`;
    li.className = "p-1 rounded mb-1 bg-gray-300 dark:bg-gray-700";
    list.appendChild(li);
  });
}

// DÃ©finir couleur selon prioritÃ©
function priorityColor(p){
  if(p<=2) return 'bg-green-200 dark:bg-green-700';
  if(p<=4) return 'bg-yellow-200 dark:bg-yellow-700';
  return 'bg-red-200 dark:bg-red-700';
}

// Suggestion prochaine tÃ¢che
function suggestNextTask() {
  if (tasks.length === 0) {
    document.getElementById('nextTaskDiv').classList.add('hidden');
    return;
  }
  const next = tasks.reduce((a,b)=>b.priority>a.priority?b:a);
  document.getElementById('nextTaskText').textContent = `${next.title} - ${next.duration} min - prioritÃ© ${next.priority}`;
  document.getElementById('nextTaskDiv').classList.remove('hidden');
}

// Micro-pauses et alertes Ã©nergie
function showEnergyAlert(val){
  const alertDiv = document.getElementById('energyAlert');
  const audio = document.getElementById('alertSound');
  alertDiv.classList.remove('hidden');
  if(val>70){
    alertDiv.textContent = "ğŸ’ª Tu es en pleine forme ! Continue comme Ã§a.";
    alertDiv.className = "mb-6 p-4 bg-green-100 dark:bg-green-900 rounded shadow fade-in";
  } else if(val>40){
    alertDiv.textContent = "âš ï¸ Niveau d'Ã©nergie moyen. Pense Ã  faire une petite pause.";
    alertDiv.className = "mb-6 p-4 bg-yellow-100 dark:bg-yellow-900 rounded shadow fade-in";
  } else {
    alertDiv.textContent = "â›” Energie faible ! Repose-toi avant de continuer.";
    alertDiv.className = "mb-6 p-4 bg-red-100 dark:bg-red-900 rounded shadow fade-in";
    audio.play();
  }
}

// Enregistrer Ã©nergie
function logEnergy() {
  const val = parseInt(document.getElementById('energy').value);
  lastEnergy = val;
  energyLog.push(val);
  if(energyLog.length>20) energyLog.shift();
  document.getElementById('lastEnergy').textContent = 'DerniÃ¨re Ã©nergie : '+val;
  drawChart();
  showEnergyAlert(val);
  updateBadge();
}

// Graphique
let chart = null;
function drawChart() {
  const ctx = document.getElementById('energyChart').getContext('2d');
  if(chart) chart.destroy();
  chart = new Chart(ctx,{
    type:'line',
    data:{
      labels: Array(energyLog.length).fill('').map((_,i)=>i===energyLog.length-1?'Maintenant':''),
      datasets:[{label:'Ã‰nergie', data: energyLog, borderColor:'blue', fill:false, tension:0.3}]
    }
  });
}

// Badge motivant
function updateBadge() {
  const div = document.getElementById('badgeDiv');
  const text = document.getElementById('badgeText');
  if(tasks.length===0){
    div.classList.add('hidden');
  } else if(lastEnergy>70){
    text.textContent = "ğŸ† Productif ! Tu es au top de ton Ã©nergie.";
    div.classList.remove('hidden');
  } else if(lastEnergy>40){
    text.textContent = "ğŸŒŸ Zen : continue doucement mais sÃ»rement.";
    div.classList.remove('hidden');
  } else {
    text.textContent = "ğŸ›Œ Repos conseillÃ© pour recharger tes batteries.";
    div.classList.remove('hidden');
  }
}

// Initialisation
renderTasks();
renderCompleted();
suggestNextTask();
drawChart();
updateBadge();
</script>

</body>
</html>
