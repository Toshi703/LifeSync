<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>LifeSync Ultimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>

<style>
.fade { animation: fade 0.4s ease }
@keyframes fade {
  from {opacity:0; transform:translateY(10px)}
  to {opacity:1; transform:translateY(0)}
}
.glass {
  backdrop-filter: blur(12px);
  background: rgba(255,255,255,0.75);
}
.dark .glass {
  background: rgba(30,41,59,0.75);
}
</style>
</head>

<body class="bg-gradient-to-br from-indigo-100 via-blue-100 to-emerald-100 
dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 
min-h-screen p-6 text-gray-800 dark:text-gray-100 transition">

<h1 class="text-4xl font-black text-center mb-1">ğŸ§  LifeSync</h1>
<p class="text-center opacity-70 mb-6">Ton copilote personnel</p>

<!-- Ã‰NERGIE -->
<div class="glass rounded-xl p-4 mb-4 shadow fade">
  <h2 class="font-bold mb-2">âš¡ Ã‰nergie actuelle</h2>
  <input id="energy" type="range" min="0" max="100" class="w-full">
  <p id="energyText" class="mt-1 text-sm opacity-80"></p>
</div>

<!-- AJOUT TÃ‚CHE -->
<div class="glass rounded-xl p-4 mb-4 shadow fade">
  <h2 class="font-bold mb-2">â• Ajouter une tÃ¢che</h2>
  <div class="flex flex-wrap gap-2">
    <input id="title" placeholder="TÃ¢che" class="p-2 rounded border w-full">
    <input id="duration" type="number" placeholder="DurÃ©e (min)" class="p-2 rounded border w-32">
    <select id="priority" class="p-2 rounded border">
      <option value="1">ğŸŸ¢ Faible</option>
      <option value="3">ğŸŸ¡ Moyenne</option>
      <option value="5">ğŸ”´ Haute</option>
    </select>
    <button onclick="addTask()" class="bg-indigo-600 text-white px-4 rounded">
      Ajouter
    </button>
  </div>
</div>

<!-- ACTION -->
<div class="text-center my-6 fade">
  <button onclick="decide()" class="bg-emerald-600 text-white px-6 py-3 rounded-xl text-lg shadow-lg">
    ğŸ¤” Que dois-je faire maintenant ?
  </button>
</div>

<!-- FOCUS -->
<div id="focus" class="glass rounded-xl p-6 mb-4 shadow hidden fade text-center"></div>

<!-- LISTE -->
<div class="glass rounded-xl p-4 mb-4 shadow fade">
  <h2 class="font-bold mb-2">ğŸ“‹ TÃ¢ches restantes</h2>
  <ul id="list"></ul>
</div>

<!-- BILAN -->
<div class="glass rounded-xl p-4 shadow fade">
  <h2 class="font-bold mb-2">ğŸ“Š Bilan</h2>
  <p id="stats"></p>
</div>

<script>
let data = JSON.parse(localStorage.getItem("lifesync")) || {
  tasks: [],
  worked: 0,
  sessions: 0
};

const energy = document.getElementById("energy");
const energyText = document.getElementById("energyText");

energy.value = 70;
energyText.textContent = "70% â€” forme correcte";

energy.oninput = ()=>{
  energyText.textContent = energy.value+"%";
}

function save() {
  localStorage.setItem("lifesync", JSON.stringify(data));
}

function addTask() {
  if(!title.value.trim()) return;
  data.tasks.push({
    title: title.value,
    duration: Number(duration.value||30),
    priority: Number(priority.value)
  });
  title.value="";
  render();
  save();
}

function render() {
  list.innerHTML="";
  data.tasks.forEach(t=>{
    let li=document.createElement("li");
    li.className="p-2 rounded mb-1 bg-white/60 dark:bg-slate-700/60";
    li.textContent=`${t.title} â€¢ ${t.duration} min`;
    list.appendChild(li);
  });
  stats.innerHTML = `
    â±ï¸ Temps productif : <b>${data.worked} min</b><br>
    ğŸ§  Sessions focus : <b>${data.sessions}</b>
  `;
}

function decide() {
  if(data.tasks.length===0) return;

  const e = Number(energy.value);
  let best = data.tasks.sort((a,b)=>{
    let sa = a.priority*3 - a.duration + e;
    let sb = b.priority*3 - b.duration + e;
    return sb-sa;
  })[0];

  focus.innerHTML = `
    <h2 class="text-2xl font-bold mb-2">ğŸ¯ Focus</h2>
    <p class="text-lg mb-2">${best.title}</p>
    <p class="opacity-70 mb-4">â±ï¸ ${best.duration} minutes</p>
    <button onclick="complete('${best.title}')" class="bg-indigo-600 text-white px-6 py-2 rounded-xl">
      âœ… TerminÃ©
    </button>
  `;
  focus.classList.remove("hidden");
}

function complete(title) {
  let t = data.tasks.find(x=>x.title===title);
  data.worked += t.duration;
  data.sessions++;
  data.tasks = data.tasks.filter(x=>x.title!==title);
  focus.classList.add("hidden");
  render();
  save();
}

render();
</script>

</body>
</html>
